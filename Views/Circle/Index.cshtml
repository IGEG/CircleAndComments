@{
    ViewData["Title"] = "CircleAndComments";
    Layout = "_Layout";
}
<body>
    <div id="container"></div>
</body>
<script type="text/javascript">

$(document).ready(function() {
    $.ajax({
        url: "/Circle/GetAllCirclesAndComments",
        dataType: "json",
        success: function(data) {
           
//konva
            var width = window.innerWidth;
            var height = window.innerHeight;
            var stage = new Konva.Stage({ container: 'container', width: width, height: height, });
            var layer = new Konva.Layer();
// for по массиву кругов
            for (var i = 0; i < data.length; i++) {

//группа объектов

            var group = new Konva.Group({});

// создем объект Circle. метод getCircle() возвращает объект Konva.Circle

            const newCircle = new Circle(data[i].PointX, data[i].PointY, data[i].Radius, data[i].Color);
            var circle = newCircle.getCircle();

            group.add(circle);
            var Textheight = 20;

// for по массиву комментариев к каждому кругу

                for (var j = 0; j < data[i].CommentsInCircle.length; j++) {
             

// создем объект Text. метод getText() возвращает объект Konva.Text
                Textheight = Textheight + 35;
                const newText = new Text(data[i].PointX, (data[i].PointY + Textheight), data[i].CommentsInCircle[j].Text);
                var text = newText.getText();

                 text.offsetX(text.width() / 2);

                 var widthRectangle= text.width();
                 var heightRectangle= text.height();

                 const newRectangle = new Rectangle(data[i].PointX, (data[i].PointY + Textheight),data[i].CommentsInCircle[j].Color,widthRectangle,heightRectangle);
                 var rectangle = newRectangle.getRectangle();

                 rectangle.offsetX(rectangle.width() / 2);

//добавляем в группу text и rectangle

                group.add(rectangle);
                group.add(text);
                }
                layer.add(group);
                stage.add(layer);

            }

        }
    });
});
</script>
